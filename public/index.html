<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Voice listener and recorder with voiceCmdr</title>
  </head>
  <body>
    <p>Say: "Go [something]".</p>

    <p id="received">Received command: <span id="something"></span></p>
    <p>Inserted: <span id="result"></span></p>
    <p id="speech">Stored Speech:
      <table>
        <tbody id="tbody"></tbody>
      </table>
    </p>

    <script src="js/voiceCmdr.js"></script>
    <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
    <script>
      function getSnippets() {
        var getting = $.get('http://127.0.0.1:8080/api/snippets');
        // Put the results in a div
        getting.done(function (data) {
          //console.log(data);
          var globalCounter = 0;
          var tbody = document.getElementById('tbody');
          tbody.innerHTML = "";
          //for (var i = 0; i < Object.keys(data).length; i++) {
          for (var i = Object.keys(data).length; i > 0; i--) {
            var tr = "<tr>";
            tr += "<td>";
            if (i == Object.keys(data).length) {
              tr += "<b>";
            }
            tr += data[i-1].content.toString();
            if (i == Object.keys(data).length) {
              tr += "</b>";
            }
            tr + "</td></tr>";
            tbody.innerHTML += tr;
          }
        });
      };
      $("#speech").click(function(){
        getSnippets();
      });
    </script>
    <script>
      //$("#something").click(function(){
      $('#received').on('change','#something', function() {
        //alert('wahooo!');
        console.log("Posting Data:" + $('#something').text());
        var posting = $.post('http://127.0.0.1:8080/api/snippets', {"content": $('#something').text()});

        // Put the results in a div
        posting.done(function (data) {
          $("#result").empty().append(data.result);
          getSnippets();
        });
      });
    </script>
    <script src="js/app.js"></script>
  </body>
</html>